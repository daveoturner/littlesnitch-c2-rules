{
  "name": "Enhanced Malware Defense",
  "description": "Advanced malware defense including data exfiltration detection, camera/microphone protection, and file access monitoring",
  "rules": [
    {
      "action": "deny",
      "process": "any",
      "remote-ports": "21,22,23,3389",
      "protocol": "tcp", 
      "notes": "Block unauthorized remote access protocols (FTP, SSH, Telnet, RDP)"
    },
    {
      "action": "deny",
      "process": "/tmp/*",
      "remote": "any",
      "notes": "Block network access for processes running from /tmp"
    },
    {
      "action": "deny", 
      "process": "/var/tmp/*",
      "remote": "any",
      "notes": "Block network access for processes in /var/tmp"
    },
    {
      "action": "deny",
      "process": "/Users/*/Downloads/*",
      "remote": "any",
      "notes": "Block network access for downloaded executables"
    },
    {
      "action": "ask",
      "process": "any",
      "remote-domains": "*.onion",
      "notes": "Alert on Tor hidden service access attempts"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-ports": "9050,9051", 
      "protocol": "tcp",
      "notes": "Block Tor SOCKS and control ports"
    },
    {
      "action": "ask",
      "process": "any",
      "remote-ports": "1080",
      "protocol": "tcp",
      "notes": "Monitor SOCKS proxy usage (potential C2)"
    },
    {
      "action": "deny",
      "process": "/usr/bin/python*",
      "remote": "any",
      "notes": "Block Python network access (unless whitelisted)"
    },
    {
      "action": "deny",
      "process": "/usr/bin/ruby",
      "remote": "any", 
      "notes": "Block Ruby network access (unless whitelisted)"
    },
    {
      "action": "deny",
      "process": "/bin/bash",
      "remote": "any",
      "notes": "Block bash network access (shell-based malware)"
    },
    {
      "action": "deny",
      "process": "/bin/sh",
      "remote": "any",
      "notes": "Block sh network access"
    },
    {
      "action": "ask",
      "process": "/Applications/Parallels Desktop.app/*",
      "remote": "any", 
      "notes": "Monitor all VM network activity for C2 patterns"
    },
    {
      "action": "ask",
      "process": "/usr/local/bin/docker",
      "remote": "any",
      "notes": "Monitor Docker container networking"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-ports": "6666,6667,6668,6669",
      "protocol": "tcp",
      "notes": "Block IRC ports commonly used for botnets"
    },
    {
      "action": "deny",
      "process": "any", 
      "remote-ports": "1234,12345,54321",
      "protocol": "tcp",
      "notes": "Block common backdoor ports"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-ports": "31337,65535",
      "protocol": "tcp",
      "notes": "Block elite/max backdoor ports"
    },
    {
      "action": "ask",
      "process": "any",
      "remote-domains": "*.duckdns.org",
      "notes": "Monitor Dynamic DNS usage (common in C2)"
    },
    {
      "action": "ask",
      "process": "any", 
      "remote-domains": "*.no-ip.org",
      "notes": "Monitor No-IP dynamic DNS"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-domains": "*.bit",
      "notes": "Block Namecoin DNS (.bit domains)"
    },
    {
      "action": "ask",
      "process": "any",
      "remote-ips": "192.168.0.0/16",
      "notes": "Monitor internal network scanning attempts"
    },
    {
      "action": "ask",
      "process": "any",
      "remote-ips": "10.0.0.0/8", 
      "notes": "Monitor private network access"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-ips": "127.0.0.0/8",
      "remote-ports": "3333,4444,5555,8080",
      "notes": "Block localhost C2 communication attempts"
    },
    {
      "action": "ask",
      "process": "any",
      "remote": "any",
      "owner": "root",
      "notes": "Monitor all root process network activity"
    },
    {
      "action": "deny",
      "process": "any",
      "remote-domains": "*.tk",
      "notes": "Block Tokelau TLD (commonly abused)"
    },
    {
      "action": "deny", 
      "process": "any",
      "remote-domains": "*.ml",
      "notes": "Block Mali TLD (commonly abused)"
    }
  ]
}